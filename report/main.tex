%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% University/School Laboratory Report
% LaTeX Template
% Version 4.0 (March 21, 2022)
%
% This template originates from:
% https://www.LaTeXTemplates.com
%
% Authors:
% Vel (vel@latextemplates.com)
% Linux and Unix Users Group at Virginia Tech Wiki
%
% License:
% CC BY-NC-SA 4.0 (https://creativecommons.org/licenses/by-nc-sa/4.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[
    letterpaper, % Paper size, specify a4paper (A4) or letterpaper (US letter)
    10pt, % Default font size, specify 10pt, 11pt or 12pt
]{CSUniSchoolLabReport}

\usepackage[french]{babel}
\usepackage{indentfirst}
\usepackage[pdftex]{hyperref}
\hypersetup{
    colorlinks,
    linkcolor={red!50!black},
    citecolor={blue!50!black},
    urlcolor={blue!80!black}
}
\usepackage{lipsum}
\usepackage{xcolor}
\colorlet{LightGray}{white!95!black}
\usepackage{minted}
\usepackage[nameinlink,noabbrev]{cleveref}
\newcommand{\fig}[1]{\cref{fig:#1}}
\newcommand{\code}[1]{\cref{code:#1}}
\usepackage[justification=centering]{caption}


% Displays a syntax-highlighted code block from a file with caption, that gets
% labelled with its path
% #1 : File with code
% #2 : Language
% #3 : Caption
\newcommand{\Codeblock}[3]{
    \begin{figure}[h]
        \centering
        \inputminted
        [
            linenos,
            frame=lines,
            framesep=2mm,
            breaklines,
            fontsize=\footnotesize,
            bgcolor=LightGray,
            baselinestretch=1
        ]{#2}{#1}

        \captionsetup{singlelinecheck=off}
        \caption{#3}
        \label{code:#1}
    \end{figure}
}

%----------------------------------------------------------------------------------------
%	REPORT INFORMATION
%----------------------------------------------------------------------------------------

\title{Systèmes Temps Réel\\Travaux pratiques} % Report title

\author{Robin \textsc{SHAMSNEJAD}} % Author name(s), add additional authors like: '\& James \textsc{Smith}'

\date{\today} % Date of the report

%----------------------------------------------------------------------------------------

\begin{document}

\maketitle

%----------------------------------------------------------------------------------------

\section*{Objectif}

Le but de ce TP est de prendre en main la bibliothèque C++ \textsc{SystemC} afin
de décrire des systèmes temps réel.

\tableofcontents

%----------------------------------------------------------------------------------------

\pagebreak
\section{TP1 Partie A - Analyse d'un exemple}

\subsection{Question A.1}

Après compilation immédiate des fichiers fournis, on obtient le résultat visible
en \code{code/qA1.txt}.

\Codeblock{code/qA1.txt}{bash}{Résultat de la compilation brute}

\subsection{Question A.2}

En lisant le code, on identifie les éléments suivants :

\begin{itemize}
    \item Classe \texttt{fifo} : représente le buffer d'échange entre le
    producteur et le consommateur (channel). Y sont définies les interfaces qui
    permettront d'y entrer et sortir des données.
    \item Classes \texttt{write\_if} et \texttt{read\_if} : interfaces de
    lecture et écriture du channel \texttt{fifo}
    \item Classe \texttt{producer} : Thread d'écriture (process), possède un
    port \texttt{out} capable de se connecter à une interface de type
    \texttt{write\_if}
    \item Classe \texttt{consumer} : Thread de lecture (process), possède un
    port \texttt{in} capable de se connecter à une interface de type
    \texttt{read\_if}.
    \item Classe \texttt{top} : Le module principal
\end{itemize}

\subsection{Question A.3}

Lorsqu'on ajoute un \texttt{wait()} dans le consommateur, on observe qu'il n'a
pas le temps de vider le buffer avant le cycle suivant. Comme on peut le voir
dans la \code{code/qA3a.txt}, il n'a le temps de vider qu'un caractère à chaque
itération.

\Codeblock{code/qA3a.txt}{bash}{Résultat avec un \texttt{wait()} dans le
consommateur}

Lorsque l'on ajoute un autre \texttt{wait()} dans le producteur, cette fois on
observe qu'il n'a pas le temps de remplir le buffer : il n'a le temps d'y écrire
qu'un caractère à chaque fois comme on peut le voir dans la
\code{code/qA3b.txt}.

\Codeblock{code/qA3b.txt}{bash}{Résultat en ajoutant encore un \texttt{wait()},
dans le producteur cette fois-ci}

%----------------------------------------------------------------------------------------

\pagebreak
\section{TP1 Partie B - Modélisation d'un système simple}

\subsection{Question B.1}

En lisant le code, on identifie les éléments suivants :

\begin{itemize}
    \item Classe \texttt{FIFO} : représente le buffer d'échange entre
    \texttt{Bit2Byte} et le consommateur. Y sont définies les interfaces qui
    permettront d'y entrer et sortir des données.
    \item Classes \texttt{write\_if} et \texttt{read\_if} : interfaces de
    lecture et écriture du channel \texttt{FIFO}
    \item Classe \texttt{BitGen} : Thread de génération des bits (process)
    \item Classe \texttt{Bit2Byte} : Thread de conversion des bits en octets
    (process)
    \item Classe \texttt{Consumer} : Thread de consommation des octets générés
    (process)
    \item Classe \texttt{top} : Le module principal
\end{itemize}


%----------------------------------------------------------------------------------------

\end{document}